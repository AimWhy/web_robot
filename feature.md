# 网页自动化 + 数据爬取与处理

## 定义数据源

数据源列表：
- 唯一key
- 中文名
- 数据源类型(接口/网页/自定义)

元数据配置：
- 字段名
- 字段中文名

数据源详情：
- 爬虫流程
    - 单线程爬虫
    - 并发爬虫
- 发送请求
    - 请求定义
    - 数据解析
- 测试运行

数据源定义，数据源配置，类似配置一个表结构，有数据源名和数据源的各个字段。每个数据源中的数据都是一个对象数组的表[{},{}]  

同时还需要配置数据源的获取方式，这边有两种爬虫流程，直接请求。

爬虫流程主要用于网页的上数据的获取，也就是获取dom的innerText或者innerHtml。并发使用页面iframe多开实现。  
单线程适用如翻页场景，并发适用每页url不一样可以批定义的场景。

发送请求主要是直接获取服务器的数据，由于插件使用的是浏览器发送请求的方式，所以只要手动登录一次，请求会带上cookie以跳过后端验证。

## 数据爬取

- 立即运行
- 定时运行
- 运行状态
- 最近一次运行时间
- 数据数量
- 运行日志

数据源运行列表，所有运行都为后台运行。立即运行则马上运行一次。定时运行则可以设置运行时间。运行状态使用最近一次运行的状态。  
运行日志记录详细的获取数据地址和每次获取到的数据，解析后的数据。

## 数据处理

- js脚本任务 -> 新的数据源

js脚本中会默认将所有数据源的作为key变量赋值数据，  
可在其之上进行批处理操作。

## 数据导出/可视化

- 导出文件（json）
- 数据可视化页
    - 操作元数据作图

# 流程定义，调试与编排

开启流程定义与编排页入口

打开插件页，点击开启流程定义与编排按钮

将开启一个新的空白标签页面，作为定义测试目标页

流程定义与编排页面将会由一个新的chrome窗口打开。

两个窗口相互独立（可自行排版左右或两块屏幕定义）

## [左] 流程事件列表

**功能要点**

### 展示事件列表
- 一行一个展示，事件名超出展示...
- 可拖拽进行上下编排
- 右侧有竖状点，包括（展示详情，运行单个，运行至这个）
- 展示详情点击则弹出modal列出事件详情，modal中有编辑
- 运行单个则表示单个事件，运行至这个则从头运行至此
- 上方有运行全部icon，点击运行当前所有事件

### 事件运行参数

#### 系统运行参数
系统运行参数开关，会影响运行的日志输出

- 开启接口监听，配置接口匹配路由  
- 开启页面变化监控
- 开启数据监控

#### 自定义参数
- 上方点击配置运行参数，弹出参数配置框textarea
- 使用一行一个key=v表示参数

### 事件运行数据可视化

- 上方有icon，点击使用k=v展示运行过程中爬的数据

### 运行日志
运行前检查结果
打印运行过程中上报的日志

## [右] 事件库

### 全部临时事件展示
- 每个方形代表一个事件，展示事件名，点击展示事件详情modal
- 事件可以拖到左侧
- 拖进左侧前进行测试是否定义全

### 事件定义
- 右下角有，开始录制添加事件，页面选取添加事件，自定义事件按钮

### 自定义事件
- 自定义浏览器事件，点击打开modal
- 使用queryselectAll自定义选择器

### 全局配置
左下角有全局配置按钮，点击打开全局配置项，影响新定义的事件

- 默认选择器：混合选择器，值选择器，元素选择器
- 默认开启dom检查：开/关
- 默认延时：0
